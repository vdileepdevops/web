<div class="row">
    <div class="col-md-6 col-xl-6 ">
      <p class="bc-2">Interest Report</p>
    </div>
   
  </div>

  <div class="row mt-3">
    <div class="col-md-12 col-xl-12">
      <div class="section-container">
        <form [formGroup]="InterestReportForm" autocomplete="off">
       <div class="row mt-1">
            
  
            <div class="col-md-4 col-xl-4">
              <label id="pSchemeId" title="Scheme Name">Scheme Name</label>
              <select class="form-control" formControlName="pSchemeId" (change)="shemename_change($event)" [ngClass]="{ 'is-invalid': InterestPaymentErrors.pSchemeId }">
                <option ng-selected="selected" value="">Select</option>
                <option *ngFor="let i of SchemeDetails" [value]="i.pSchemeId">{{i.pSchemename}}</option>
  
              </select>
              <div class="invalid-feedback">
                <span *ngIf="InterestPaymentErrors.pSchemeId">{{InterestPaymentErrors?.pSchemeId}}</span>
              </div>
  
            </div>
            <div class="col-md-4 col-xl-4">
              <label id="padjustmenttype" title="Adjustment Type">Adjustment Type</label>
              <select class="form-control" id="padjustmenttype" title="Adjustment Type" formControlName="padjustmenttype" (change)="adjustmentTypeChange($event)" [ngClass]="{ 'is-invalid': InterestPaymentErrors.padjustmenttype }">
                <option value="SELF" ng-selected="selected">SELF</option>
                <option value="ADJUSTMENT" ng-selected="selected">ADJUSTMENT</option>
              </select>
              <div class="invalid-feedback">
                <span *ngIf="InterestPaymentErrors.padjustmenttype">{{InterestPaymentErrors?.padjustmenttype}}</span>
              </div>
  
            </div>
  
            <div class="col-md-12" *ngIf="showCompany">
              <div class="row">
                <div class="col-md-4 col-xl-4">
                  <div class="form-group">
                    <label id="pcompanyname" title="Company Name">Company Name</label>
                    <select class="form-control" formControlName="pcompanyname" (change)="GetBranchDetailsIP($event)"  [ngClass]="{ 'is-invalid': InterestPaymentErrors.pcompanyname }">
                      <option ng-selected="selected" value="">Select</option>
                      <option *ngFor="let i of CompanyDetails" [value]="i.pCompanyname">{{i.pCompanyname}}</option>
                    </select>
                    <div class="invalid-feedback">
                      <span *ngIf="InterestPaymentErrors.pcompanyname">{{InterestPaymentErrors?.pcompanyname}}</span>
                    </div>
  
                  </div>
                </div>
                <div class="col-md-4 col-xl-4">
                  <div class="form-group">
                    <label id="pbranchnamemain" title="Branch Name">Branch Name</label>
                    <select class="form-control col-md-12" formControlName="pbranchnamemain" (change)="branchNameChange($event)" [ngClass]="{ 'is-invalid': InterestPaymentErrors.pbranchnamemain }">
                      <option ng-selected="selected" value="">Select</option>
                      <option *ngFor="let i of BranchDetails" [value]="i.pBranchname">{{i.pBranchname}}</option>
                    </select>
                    <div class="invalid-feedback">
                      <span *ngIf="InterestPaymentErrors.pbranchnamemain">{{InterestPaymentErrors?.pbranchnamemain}}</span>
                    </div>
  
  
  
  
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-4  col-xl-4">
                  <div class="form-group">
                    <label id="pMonthOf" title="Month Of">Month Of</label>
  
                    <input class="form-control col-md-12" type="text" value="" [bsConfig]="dpConfig" #dp="bsDatepicker"
                           bsDatepicker placeholder="mmm/YY" formControlName="pMonthOf" (ngModelChange)="DateChange($event)"
                           (onShown)="onOpenCalendar($event)" [ngClass]="{ 'is-invalid': InterestPaymentErrors.pMonthOf }">
                    <div class="invalid-feedback">
                      <span *ngIf="InterestPaymentErrors.pMonthOf">{{InterestPaymentErrors?.pMonthOf}}</span>
                    </div>
  
                  </div>
                </div>
  
                <div class="col-md-8 col-xl-8 justify-content-end pull-right">
                  <div class="form-group mt-4 pt-1">
  
                    <div class="col-md-12 col-xl-12 p-0 pull-right">
                      <div class="form-group mt-2 pt-1">
  
                        <div class="d-flex justify-content-end">
                          <a href="#" data-toggle="modal" data-target="#member-details" (click)="GetShowmemberdetails()"
                             class="btn btn-b-icon px-3 border-0 collapsed" aria-expanded="false">
                            <img src="assets/images/icon-add-white.svg" width="20px" height="20px" class="mr-3">Show
                          </a>
                        </div>
                      </div>
                    </div>
                 
                  </div>
                </div>
              </div>
              <!------------------Start-Grid----------------------------------------->
  
              <div class="row">
  
  
  
  
  
                <div class="col-md-12 col-xl-12 pt-4 ">
  
                
                    <kendo-grid [kendoGridBinding]="Showmembers"
                                 [sortable]="true" [selectedKeys]="mySelection" 
                                (remove)="removeHandler($event)"
                                [skip]="skip" height="500"
                                [selectable]="selectableSetting">
  
                                <ng-template kendoGridToolbarTemplate>
                                  <div class="mb-3">
                                    <div class="col-12 mt-2">
                                      <ul class="temp-ul pull-right">
                                        <li class="temp-ico ml-2">
                                          <a kendoGridPDFCommand><img class="pt-2" src="assets/images/pdf-icon-blue.svg " title="pdf"
                                              width="20px"></a></li>
                                        <li class="temp-ico ml-2">
                                          <a kendoGridExcelCommand><img class="pt-2" src="assets/images/icon-excel.svg " title="excel"
                                              width="20px"></a></li>
                                      </ul>
                                    </div>
                                  </div>
                                </ng-template>    
                      
                      <kendo-grid-column field="pMembername" title="Member" width="200">
                      </kendo-grid-column>
                      <kendo-grid-column field="pInterestpaymentid" hidden="hidden" title="InterestpaymentId" width="100">
                      </kendo-grid-column>
                      <kendo-grid-column field="pdebitaccountid" hidden="hidden" title="DebitaccountId" width="100">
                      </kendo-grid-column>
                      <kendo-grid-column field="pAdvanceacno" title="Advance A/C" width="140"></kendo-grid-column>
                      <kendo-grid-column field="pInterestPayable" title="Interest Payable" class="kendo-center" width="150">
                        <ng-template kendoGridCellTemplate let-dataItem>
                          {{dataItem.pInterestPayable |currencypipewithdecimal }}
                        </ng-template>
                        <ng-template kendoGridFooterTemplate>
                          <p class="bc-2 text-center"> {{totalinterestpayable| mycurrencypipe}}</p>
                        </ng-template>
                      </kendo-grid-column>
                      <kendo-grid-column field="pInterestamount" title="Interest Amount" class="kendo-center" width="150">
                        <ng-template kendoGridCellTemplate let-dataItem>
                          {{dataItem.pInterestamount |currencypipewithdecimal }}
                        </ng-template>
                        <ng-template kendoGridFooterTemplate>
                          <p class="bc-2 text-center"> {{totalinterestamount| mycurrencypipe}}</p>
                        </ng-template>
                      </kendo-grid-column>
                      <kendo-grid-column field="pTdsamount" title="TDS Amount" class="kendo-center" width="130">
                        <ng-template kendoGridCellTemplate let-dataItem>
                          {{dataItem.pTdsamount |currencypipewithdecimal }}
                        </ng-template>
                        <ng-template kendoGridFooterTemplate>
                          <p class="bc-2 text-center"> {{totaltdsamount| mycurrencypipe}}</p>
                        </ng-template>
                      </kendo-grid-column>
                      <kendo-grid-column field="pInterestPayable" title="Total Amount" hidden="hidden" width="140" class="kendo-center">
                        <ng-template kendoGridCellTemplate let-dataItem>
                          {{dataItem.pInterestPayable |currencypipewithdecimal }}
                        </ng-template>
                      </kendo-grid-column>


                     <kendo-grid-pdf fileName="Interest_Report.pdf" [allPages]="true" paperSize="A2" [repeatHeaders]="true"
                                        [landscape]="true">

                          <kendo-grid-pdf-margin top="8cm" left="1cm" right="1cm" bottom="2cm"></kendo-grid-pdf-margin>

                          <ng-template kendoGridPDFTemplate>
                            <div class="page-template">
                              <div class="header">
                                <app-company-details></app-company-details>

                              </div>

                            </div>
                          </ng-template>

                        </kendo-grid-pdf>
                      <kendo-grid-excel fileName="Interest_Report.xlsx"></kendo-grid-excel>
                    </kendo-grid>
   
                </div>
  
  
  
  
              </div>
              <!-----------------End-Grid ---------------------------------------formControlName="pTotalpaymentamount"-------------->
             
              
  
  
              <!----------------------------Mode of Payment------------------------------------->
             
            </div>
  </div>
             </form>
  
  <!------------- save Buttons ------------>
  
  
  <!------------- save Buttons ------------>
  
  </div>
  </div>
  
  
  </div>
