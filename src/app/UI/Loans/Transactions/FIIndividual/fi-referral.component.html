<div class="row mt-5 mb-3">
  <div class="col-md-6 col-xl-4"> <a class="bc-2 mb-2 text-decoration-none">  Referral</a> </div>
 <div class="col-md-6 col-xl-4">
   <div class="material-switch pull-right"><span class="mr-2">Not applicable</span>
     <input id="Referral" name="Referral" type="checkbox" [(ngModel)]="notApplicableForReferralFlag" (change)="notApplicableAllForReferral($event)" >
     <label for="Referral" class="check-danger"></label>
   </div>
  </div>
</div> 
<!-- (change)="notApplicableAll($event)" -->
<form [formGroup]="referralForm">
<div class="row" *ngIf="!notApplicableForReferralFlag">
<div class="col-md-4 col-xl-4">       
 <!-- <div class="form-group">
     <label class="mt-1" id="pReferralname" title="Select Referral/Channel Partner/Agent">Select Referral/Channel Partner/Agent</label>
   <div class="input-group">
     <select id="" class="form-control" formControlName="pReferralname"  [ngClass]="{ 'is-invalid': referralTypeErrorMessage.pReferralname}">
       <option value="" ng-selected="selected">Select</option>
       <option *ngFor="let referralAgent of referralAgents;trackBy: trackByFn"
               [value]="referralAgent.pAdvocateName">
         {{referralAgent.pAdvocateName}}
       </option>
     </select>
     <div class="input-group-append">
       <button class="btn btn-lg-icon px-2 p-0" data-target="#referral" data-toggle="modal" tabindex="-1"> <img src="assets/images/icon-add-blue.svg" class="" width="20px" height="20px"></button>
     </div>
   </div>
   <div class="invalid-feedback-cst">
       <span
         *ngIf="referralTypeErrorMessage.pReferralname">{{referralTypeErrorMessage.pReferralname}}</span>
     </div>
 </div> -->
 <fieldset>
  <div class="form-group">
     <label class="mt-1" for="" id="pReferralname" title="Select Referral/Channel Partner/Agent">Select Referral/Channel Partner/Agent</label>
     <div  class="form-group ">
                      
         <div class="demo-section k-content">
             <input id="refcontacts" name="Select Referral/Channel Partner/Agent" formControlName="pReferralname" style="width: 100%;"   [ngClass]="{ 'is-invalid': referralTypeErrorMessage.pReferralname}"/>
         </div> 
         <div class="invalid-feedback-cst">
          <span
            *ngIf="referralTypeErrorMessage.pReferralname">{{referralTypeErrorMessage.pReferralname}}</span>
        </div>         
     </div>
  </div>
  </fieldset>
  <!-- <div class="loans-card  mb-4 " *ngIf="ShowImageCard">
     <div class="row">
         <div class="col-12 pt-2">
             <div class="dropdown lc-dd col-auto position-absolute float-right" style="right:0px;">
                 <button class="btn dropdown-toggle border-0" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" > <img
                         src="assets/images/icon-more-dots-blue.svg" width="25px" height="25px"> </button>
                 <div class="dropdown-menu" aria-labelledby="dropdownMenuButton1"> <a class="dropdown-item" href="#">Action</a> <a class="dropdown-item" href="#">Another action</a> <a class="dropdown-item" href="#">Something else here</a> </div>
             </div>
             <div class="user-pic"> <img [src]="croppedImage"> </div>
         </div>
         <div class="col-12 pt-2">
             <p class="lc-title text-center mb-auto">{{referralAgents?.pAdvocateName}}</p>
             <div class="mt-3">
                 <p class="lc-sub-title mb-0 text-center mt-3">{{referralAgents?.pBusinessEntitycontactNo}}</p>
                 <p class="lc-txt mb-0 mt-1 text-center"> Unique ID - {{referralAgents?.pReferralId}} </p>
             </div>
         </div>                
     </div>              
  </div> -->
</div>
<div class="col-md-4 col-xl-4 ">        
 <!-- <div class="form-group">
     <label class="mt-1"id="pSalespersonname" title="Select Sales Personnel">Select Sales Personnel</label>
   <div class="input-group">
     <select class="form-control" formControlName="pSalespersonname"  [ngClass]="{ 'is-invalid': referralTypeErrorMessage.pSalespersonname}">
       <option value="" ng-selected="selected">Select</option>
       <option *ngFor="let allEmployee of allEmployeeDetails;trackBy: trackByFn"
               [value]="allEmployee.pEmployeeName">
         {{allEmployee.pEmployeeName}}
       </option>
     </select>
      <div class="input-group-append">
       <button class="btn btn-lg-icon px-2 p-0" data-target="#salesPersonnel" data-toggle="modal" tabindex="-1"> <img src="assets/images/icon-add-blue.svg" class="" width="20px" height="20px"></button>
     </div>
   </div>
   <div class="invalid-feedback-cst">
       <span
         *ngIf="referralTypeErrorMessage.pSalespersonname">{{referralTypeErrorMessage.pSalespersonname}}</span>
     </div>
 </div> -->

 <fieldset>
  <div class="form-group">
     <label class="mt-1" for="" id="pSalespersonname" title="Select Sales Personnel">Select Sales Personnel</label>
     <div  class="form-group ">
                      
         <div class="demo-section k-content">
             <input id="allEmployeecontacts" name="Select Sales Personnel" formControlName="pSalespersonname" style="width: 100%;"  [ngClass]="{ 'is-invalid': referralTypeErrorMessage.pSalespersonname}"/>
         </div>  
         <div class="invalid-feedback-cst">
          <span
            *ngIf="referralTypeErrorMessage.pSalespersonname">{{referralTypeErrorMessage.pSalespersonname}}</span>
        </div>        
     </div>
  </div>
  </fieldset>
  <!-- <div class="loans-card  mb-4 " *ngIf="ShowImageCard">
     <div class="row">
         <div class="col-12 pt-2">
             <div class="dropdown lc-dd col-auto position-absolute float-right" style="right:0px;">
                 <button class="btn dropdown-toggle border-0" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" > <img
                         src="assets/images/icon-more-dots-blue.svg" width="25px" height="25px"> </button>
                 <div class="dropdown-menu" aria-labelledby="dropdownMenuButton1"> <a class="dropdown-item" href="#">Action</a> <a class="dropdown-item" href="#">Another action</a> <a class="dropdown-item" href="#">Something else here</a> </div>
             </div>
             <div class="user-pic"> <img [src]="croppedImage"> </div>
         </div>
         <div class="col-12 pt-2"> 
             <p class="lc-title text-center mb-auto">{{allEmployeeDetails?.pEmployeeName}}</p>
             <div class="mt-3">
                 <p class="lc-sub-title mb-0 text-center mt-3">{{allEmployeeDetails?.pEmployeeContactNo}}</p>
                 <p class="lc-txt mb-0 mt-1 text-center"> Unique ID - {{allEmployeeDetails?.pContactRefNo}} </p>
             </div>
         </div>                
     </div>              
  </div> -->
</div>
</div>


<!-- <fieldset [disabled]="value">
<div class="form-group">
   <label class="mt-1" for="" id="pReferralname">Select Referral/Channel Partner/Agent</label>
   <div  class="form-group ">
                    
       <div class="demo-section k-content">
           <input id="refcontacts" name="Contact" formControlName="pReferralname" style="width: 100%;"  required/>
       </div>          
   </div>
</div>
</fieldset>
<div class="loans-card  mb-4 " *ngIf="ShowImageCard">
   <div class="row">
       <div class="col-12 pt-2">
           <div class="dropdown lc-dd col-auto position-absolute float-right" style="right:0px;">
               <button class="btn dropdown-toggle border-0" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" > <img
                       src="assets/images/icon-more-dots-blue.svg" width="25px" height="25px"> </button>
               <div class="dropdown-menu" aria-labelledby="dropdownMenuButton1"> <a class="dropdown-item" href="#">Action</a> <a class="dropdown-item" href="#">Another action</a> <a class="dropdown-item" href="#">Something else here</a> </div>
           </div>
           <div class="user-pic"> <img [src]="croppedImage"> </div>
       </div>
       <div class="col-12 pt-2"><p>{{referralAgents|json}}</p>
           <p class="lc-title text-center mb-auto">{{referralAgents?.pAdvocateName}}</p>
           <div class="mt-3">
               <p class="lc-sub-title mb-0 text-center mt-3">{{referralAgents?.pBusinessEntitycontactNo}}</p>
               <p class="lc-txt mb-0 mt-1 text-center"> Unique ID - {{referralAgents?.pReferralId}} </p>
           </div>
       </div>                
   </div>              
</div> -->
</form>




<div class="row mt-4 ml-1">
<div class="col-md-12 col-xl-12">
<div class="col-md-12 col-xl-12">
 <div class="d-flex justify-content-end mt-4">
   <a *ngIf="forClearButton" (click)="clearFormData()" class="btn btn-g-icon mr-4 px-3 border-0">
     <img src="assets/images/icon-cancel-white.svg" width="20px" height="20px" class="mr-3" />Clear</a> 
     <a href="#" data-toggle="tab" class="btn btn-g-icon px-3 border-0 mr-4" (click)="moveToPreviousTab()" role="tab" aria-controls="hot" aria-selected="false">
       <img src="assets/images/icon-chewron-left-whitesolid.svg" width="20px" height="20px" class="mr-3" />Back</a> 
      
       <!-- <a href="#mandatorykyc" data-toggle="tab" class="btn btn-b-icon px-3 border-0 "
        (click)="firstinformationSaveapplication()" role="tab" aria-controls="hot" aria-selected="false" >
         <img src="assets/images/icon-check-white.svg" width="20px" height="20px"
          class="mr-3" />Submit</a>  -->
        
          <button (click)="firstinformationSaveapplication()" data-toggle="tab" class="btn btn-b-icon px-3 border-0" role="tab"
          aria-controls="hot" aria-selected="false" [disabled]="isLoading">
          <i class="fa" [ngClass]="{'fa-spin fa-spinner': isLoading,'fa-check': !isLoading}"></i>
          <span *ngIf="!isLoading">
          </span>{{buttonName}}</button>

        </div>
</div>
</div>
</div>

<!-- The Modal For Sales Personnel Model -->
<div class="modal right slideInRight" id="salesPersonnel" tabindex="-1" role="dialog">
<div class="modal-dialog" style="margin-right:0px !important; ">
<div class="model-cst modal-content">

 <div class="modal-body">

   <button type="button" class="close" data-dismiss="modal">&times;</button>
   <form [formGroup]="salesPersonnelModelForm" autocomplete="off">
     <div class="form-group">
       <label id="selectAgent" title="Id Proof Type">Add Sales Personnel</label>
       <input type="text" class="form-control" formControlName="selectAgent" placeholder="Enter Sales Personnel"
              [ngClass]="{ 'is-invalid': referralTypeErrorMessage.selectAgent }" />

       <div class="invalid-feedback">
         <span *ngIf="referralTypeErrorMessage.selectAgent">{{referralTypeErrorMessage.selectAgent}}</span>
       </div>
     </div>
     <div class="d-flex justify-content-end mt-4">
       <a class="close" data-dismiss="modal" class="btn btn-g-icon mr-4 px-3 border-0"
          >
         <img src="assets/images/icon-cancel-white.svg" width="20px" height="20px"
              class="mr-3">Clear
       </a>
       <a href="" data-toggle="tab" class="btn btn-b-icon px-3 border-0" role="tab" aria-controls="hot"
          aria-selected="false">
         <img src="assets/images/icon-check-white.svg" width="20px"
              height="20px" class="mr-3">Save
       </a>
     </div>
   </form>
 </div>
</div>
</div>
</div>

<!-- The Modal For Select Referral/Channel Partner/Agent Model -->
<div class="modal right slideInRight" id="referral" tabindex="-1" role="dialog">
<div class="modal-dialog" style="margin-right:0px !important; ">
<div class="model-cst modal-content">

 <div class="modal-body">

   <button type="button" class="close" data-dismiss="modal">&times;</button>
   <form [formGroup]="referralModelForm" autocomplete="off">
     <div class="form-group">
       <label id="selectReferral" title="Id Proof Type">Add Referral/Channel Partner/Agent</label>
       <input type="text" class="form-control" formControlName="selectReferral" placeholder="Enter Referral"
              [ngClass]="{ 'is-invalid': referralTypeErrorMessage.selectReferral }" />

       <div class="invalid-feedback">
         <span *ngIf="referralTypeErrorMessage.selectReferral">{{referralTypeErrorMessage.selectReferral}}</span>
       </div>
     </div>
     <div class="d-flex justify-content-end mt-4">
       <a *ngIf="forClearButton" class="close" data-dismiss="modal" class="btn btn-g-icon mr-4 px-3 border-0"
          >
         <img src="assets/images/icon-cancel-white.svg" width="20px" height="20px"
              class="mr-3">Clear
       </a>
       <a href="" data-toggle="tab" class="btn btn-b-icon px-3 border-0" role="tab" aria-controls="hot"
          aria-selected="false">
         <img src="assets/images/icon-check-white.svg" width="20px"
              height="20px" class="mr-3">Save
       </a>
     </div>
   </form>
 </div>
</div>
</div>
</div>

<div class="my-container">
  <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px' }" [template]="customLoadingTemplateForFiView">
  </ngx-loading>

</div>
