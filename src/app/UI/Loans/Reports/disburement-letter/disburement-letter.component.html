<div class="row">
    <div class="col-md-12 col-xl-12 mt-5">
        <p class="bc-2">Loan Disbursement Letter</p>
    </div>

    <div class="col-md-12">
        <ul class="nav filtered-tab nav-tabs border-0">
            <li class="active"><a data-toggle="tab" href="#yto-send" class="active" (click)="Clicknotsend()">Yet To Send<span class="badge badge-warning ml-2">{{notsend}}</span></a></li>
            <li (click)="Clicksend()"><a data-toggle="tab" href="#sent">Sent<span class="badge badge-warning ml-2">{{send}}</span></a></li>
        </ul>

        <div class="tab-content border rounded shadow-sm bg-white p-3">
            <div id="yto-send" class="tab-pane show fade in active">
                <div class="row mt-2">
                    <div class="col-md-12 col-xl-12">
                        <div class="col-md-12 col-xl-12">

                            <div class="my-container">
                                <ng-template #customLoadingTemplate>
                                    <div class="custom-class">

                                    </div>
                                </ng-template>
                                <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px' }" [template]="customLoadingTemplate"></ngx-loading>

                            </div>


                            <kendo-grid [kendoGridBinding]="DisburementLetterdata" [pageSize]="pageSize" [skip]="gridState.skip" [pageable]="{buttonCount: 2}" [sort]="gridState.sort" [sortable]="true" [resizable]="true">

                                <ng-template kendoGridToolbarTemplate>
                                    <div class="row mb-3">
                                        <div class="col-4 pl-0 mt-n1">
                                            <input placeholder="Search in all columns..." kendoTextBox class="form-control search-k-cst sb" (input)="onFilter($event.target.value)" />
                                        </div>
                                        <div class="col-7 pr-0 pl-4 ml-4">
                                            <ul class="temp-ul mt-n1 mr-n2  pull-right">
                                                <li class="temp-ico ml-2">
                                                    <a kendoGridPDFCommand><img class="pt-2" src="assets/images/pdf-icon-blue.svg " title="pdf" width="20px"></a>
                                                </li>
                                                <li class="temp-ico ml-2">
                                                    <a kendoGridExcelCommand><img class="pt-2" src="assets/images/icon-excel.svg " title="excel" width="20px"></a>
                                                </li>
                                                <!-- <li class="temp-ico ml-2"><a    (click)="print()"><img class="pt-2" src="assets/images/print-icon-blue.svg " title="print" width="20px"></a></li> -->
                                            </ul>
                                        </div>
                                    </div>


                                </ng-template>
                                <kendo-grid-column-group title="Loan Disbursement Letter (Yet To Send)" [headerClass]="{'kendo-g-center' : true}">
                                    <kendo-grid-column field="pIsprimaryAccount" title="Select" width="80">
                                        <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                                            <input type="radio" name="anotsend" [checked]="dataItem.pIsprimaryAccount" (click)="selectDisbursalletter(dataItem,rowIndex)" />
                                        </ng-template>
                                    </kendo-grid-column>



                                    <kendo-grid-column field="pVchapplicationID" title="Loan Application No" width="200"></kendo-grid-column>
                                    <kendo-grid-column field="pVoucherno" title="Voucher No" width="200"></kendo-grid-column>
                                    <kendo-grid-column field="pApplicantname" title="Applicant"></kendo-grid-column>
                                    <kendo-grid-column field="pApprovedloanamount" title="Approved Loan Amount" [headerClass]="{'kendo-right': true}" class="kendo-right">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            {{dataItem.pApprovedloanamount | mycurrencypipe}}
                                        </ng-template>
                                    </kendo-grid-column>
                                    <kendo-grid-column field="pApplicantMobileNo" title="Mobile No"></kendo-grid-column>
                                    <kendo-grid-column field="pApplicantEmail" title="Email"></kendo-grid-column>

                                </kendo-grid-column-group>
                                <kendo-grid-pdf fileName="Yet To Send Loan Disbursement Letter.pdf" paperSize="A4" [allPages]="true" [repeatHeaders]="true" [landscape]="true">
                                    <ng-template kendoGridPDFTemplate>
                                        <div class="page-template">
                                            <div class="header bc-2 text-center">
                                                <h5> Loan Disbursement Letter (Yet To Send) </h5>
                                            </div>
                                        </div>
                                    </ng-template>
                                    <kendo-grid-pdf-margin top="2cm" left="1cm" right="1cm" bottom="1cm"></kendo-grid-pdf-margin>
                                    <kendo-grid-column field="pVchapplicationID" title="Loan Application No" width="200"></kendo-grid-column>
                                    <kendo-grid-column field="pVoucherno" title="Voucher No" width="200"></kendo-grid-column>
                                    <kendo-grid-column field="pApplicantname" title="Applicant"></kendo-grid-column>
                                    <kendo-grid-column field="pApprovedloanamount" title="Approved Loan Amount" [headerClass]="{'kendo-right': true}" class="kendo-right">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            {{dataItem.pApprovedloanamount | mycurrencypipe}}
                                        </ng-template>
                                    </kendo-grid-column>
                                    <kendo-grid-column field="pApplicantMobileNo" title="Mobile No"></kendo-grid-column>
                                    <kendo-grid-column field="pApplicantEmail" title="Email"></kendo-grid-column>
                                </kendo-grid-pdf>


                                <kendo-grid-excel fileName="Yet To Send Loan Disbursement  Letter.xlsx" [fetchData]="allData">
                                    <kendo-excelexport-column-group title="Loan Disbursement  Letter (Yet To Send)" [headerCellOptions]="headerCells">
                                        <kendo-excelexport-column field="pVchapplicationID" title="Loan Application No" width="200"></kendo-excelexport-column>
                                        <kendo-excelexport-column field="pVoucherno" title="Voucher No" width="200"></kendo-excelexport-column>
                                        <kendo-excelexport-column field="pApplicantname" title="Applicant"></kendo-excelexport-column>
                                        <kendo-excelexport-column field="pApprovedloanamount" title="Approved Loan Amount" [headerClass]="{'kendo-right': true}" class="kendo-right">
                                            <ng-template kendoGridCellTemplate let-dataItem>
                                                {{dataItem.pApprovedloanamount | mycurrencypipe}}
                                            </ng-template>
                                        </kendo-excelexport-column>
                                        <kendo-excelexport-column field="pApplicantMobileNo" title="Mobile No"></kendo-excelexport-column>
                                        <kendo-excelexport-column field="pApplicantEmail" title="Email"></kendo-excelexport-column>
                                    </kendo-excelexport-column-group>
                                </kendo-grid-excel>
                            </kendo-grid>

                        </div>
                    </div>
                </div>
            </div>

            <div id="sent" class="tab-pane fade">
                <div class="row mt-2">
                    <div class="col-md-12 col-xl-12">
                        <div class="col-md-12 col-xl-12">

                            <div class="my-container">
                                <ng-template #customLoadingTemplate>
                                    <div class="custom-class">

                                    </div>
                                </ng-template>
                                <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px' }" [template]="customLoadingTemplate"></ngx-loading>

                            </div>
                            <kendo-grid [kendoGridBinding]="DisburementLetterdata" [pageSize]="pageSize" [skip]="gridState.skip" [pageable]="{buttonCount: 2}" [sort]="gridState.sort" [sortable]="true" [resizable]="true">

                                <ng-template kendoGridToolbarTemplate>
                                    <div class="row mb-3">
                                        <div class="col-4 pl-0 mt-n1">
                                            <input placeholder="Search in all columns..." kendoTextBox class="form-control search-k-cst sb" (input)="onFilter($event.target.value)" />
                                        </div>
                                        <div class="col-12">
                                            <ul class="temp-ul  pull-right">
                                                <li class="temp-ico ml-2">
                                                    <a kendoGridPDFCommand><img class="pt-2" src="assets/images/pdf-icon-blue.svg " title="pdf" width="20px"></a>
                                                </li>
                                                <li class="temp-ico ml-2">
                                                    <a kendoGridExcelCommand><img class="pt-2" src="assets/images/icon-excel.svg " title="excel" width="20px"></a>
                                                </li>
                                                <!-- <li class="temp-ico ml-2"><a    (click)="print()"><img class="pt-2" src="assets/images/print-icon-blue.svg " title="print" width="20px"></a></li> -->
                                            </ul>
                                        </div>
                                    </div>

                                </ng-template>
                                <kendo-grid-column-group title="Loan Disbursement  Letter (Sent)" [headerClass]="{'kendo-g-center' : true}">
                                    <kendo-grid-column field="pIsprimaryAccount" title="Select" width="80">
                                        <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
                                            <input type="radio" name="sent" [checked]="dataItem.pIsprimaryAccount" (click)="selectDisbursalletter(dataItem,rowIndex)" />
                                        </ng-template>
                                    </kendo-grid-column>



                                    <kendo-grid-column field="pVchapplicationID" title="Loan Application No" width="200"></kendo-grid-column>
                                    <kendo-grid-column field="pApplicantname" title="Applicant"></kendo-grid-column>
                                    <kendo-grid-column field="pVoucherno" title="Voucher No" width="200"></kendo-grid-column>
                                    <kendo-grid-column field="pApprovedloanamount" title="Approved Loan Amount" [headerClass]="{'kendo-right': true}" class="kendo-right">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            {{dataItem.pApprovedloanamount | mycurrencypipe}}
                                        </ng-template>
                                    </kendo-grid-column>
                                    <kendo-grid-column field="pApplicantMobileNo" title="Mobile No"></kendo-grid-column>
                                    <kendo-grid-column field="pApplicantEmail" title="Email"></kendo-grid-column>

                                </kendo-grid-column-group>
                                <kendo-grid-pdf fileName="Sent Loan Disbursement Letter.pdf" paperSize="A4" [allPages]="true" [repeatHeaders]="true" [landscape]="true">
                                    <ng-template kendoGridPDFTemplate>
                                        <div class="page-template">
                                            <div class="header bc-2 text-center">
                                                <h5> Loan Disbursement Letter (Sent) </h5>
                                            </div>
                                        </div>
                                    </ng-template>
                                    <kendo-grid-pdf-margin top="2cm" left="1cm" right="1cm" bottom="1cm"></kendo-grid-pdf-margin>
                                    <kendo-grid-column field="pVchapplicationID" title="Loan Application No" width="200"></kendo-grid-column>
                                    <kendo-grid-column field="pVoucherno" title="Voucher No" width="200"></kendo-grid-column>
                                    <kendo-grid-column field="pApplicantname" title="Applicant"></kendo-grid-column>
                                    <kendo-grid-column field="pApprovedloanamount" title="Approved Loan Amount" [headerClass]="{'kendo-right': true}" class="kendo-right">
                                        <ng-template kendoGridCellTemplate let-dataItem>
                                            {{dataItem.pApprovedloanamount | mycurrencypipe}}
                                        </ng-template>
                                    </kendo-grid-column>
                                    <kendo-grid-column field="pApplicantMobileNo" title="Mobile No"></kendo-grid-column>
                                    <kendo-grid-column field="pApplicantEmail" title="Email"></kendo-grid-column>
                                </kendo-grid-pdf>


                                <kendo-grid-excel fileName="Sent Loan Disbursement Letter.xlsx" [fetchData]="allData">
                                    <kendo-excelexport-column-group title="Loan Disbursement  Letter (Sent)" [headerCellOptions]="headerCells">
                                        <kendo-excelexport-column field="pVchapplicationID" title="Loan Application No" width="200"></kendo-excelexport-column>
                                        <kendo-excelexport-column field="pApplicantname" title="Applicant"></kendo-excelexport-column>
                                        <kendo-excelexport-column field="pVoucherno" title="Voucher No" width="200"></kendo-excelexport-column>
                                        <kendo-excelexport-column field="pApprovedloanamount" title="Approved Loan Amount" [headerClass]="{'kendo-right': true}" class="kendo-right">
                                            <ng-template kendoGridCellTemplate let-dataItem>
                                                {{dataItem.pApprovedloanamount | mycurrencypipe}}
                                            </ng-template>
                                        </kendo-excelexport-column>
                                        <kendo-excelexport-column field="pApplicantMobileNo" title="Mobile No"></kendo-excelexport-column>
                                        <kendo-excelexport-column field="pApplicantEmail" title="Email"></kendo-excelexport-column>
                                    </kendo-excelexport-column-group>
                                </kendo-grid-excel>
                            </kendo-grid>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="col-md-12">
        <div id="template" class="collapse fade {{DisburementLetter}} mt-4">

            <div class="my-container">
                <ng-template #customLoadingTemplate>
                    <div class="custom-class">

                    </div>
                </ng-template>
                <ngx-loading [show]="loadingletters" [config]="{ backdropBorderRadius: '3px' }" [template]="customLoadingTemplate"></ngx-loading>

            </div>

            <div class="d-flex justify-content-end mr-3">
                <ul class="temp-ul mt-4">
                    <!-- <li class="temp-ico ml-2">
              <a href=""><img src="assets/images/icon-mail-active.svg "  width="20px" class="pt-2" title="Email" />
              </a>
          </li>
          <li class="temp-ico ml-2"><a href=""><img src="assets/images/icon-sms-active.svg " width="20px" class="pt-2" title="SMS" /></a></li> -->
                    <li class="temp-ico ml-2">
                        <img src="assets/images/pdf-icon-blue.svg " width="18px" class="pt-2" title="pdf" style="cursor: pointer;" kendo-button (click)="pdf.saveAs('Loan_Disbursal_Letter_'+VchapplicationID+'_'+Voucherno+'-'+today+'.pdf')" />
                    </li>
                    <li class="temp-ico ml-2">
                        <img src="assets/images/print-icon-blue.svg " width="18px" class="pt-2" title="print" (click)="print()" style="cursor: pointer;" />
                    </li>

                </ul>

            </div>

            <kendo-pdf-export #pdf paperSize="A4" margin="10mm">
                <div id="temp-box">
                    <div class="mt-2 border shadow-sm bg-white">

                        <div class="row">
                            <div class="col-md-12">
                                <app-company-details></app-company-details>

                                <div class="report-head">
                                    <p class="font-16 text-dark text-center mb-0">
                                        Loan Disbursement Letter
                                    </p>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="temp-box-inner border rounded shadow-sm bg-white p-3 pt-0" style="overflow:hidden; height:auto !important;">

                        <div class="row">
                            <div class="col-md-4">
                                <div class="font-18 text-dark text-left">
                                    <span class="mr-6 sec-head-black">Place :</span>
                                    <span class="sec-head-black"> Hyderabad</span>

                                </div>
                                <p class="font-18 text-dark text-left">
                                    <span class="mr-2 sec-head-black">Date :</span>
                                    <span class="sec-head-black">{{Disburementdate | date:'dd-MM-yyyy'}},</span>
                                </p>

                                <p class="font-18 text-dark text-left">
                                    To<br /> {{Applicantname}} ,<br />
                                    <span *ngIf="Applicantaddress1!=''">{{Applicantaddress1}}<br /></span>
                                    <span *ngIf="Applicantcity!=''">{{Applicantcity}}<br /></span>
                                    <span *ngIf="Applicantdistrict!=''">{{Applicantdistrict}}<br /></span>
                                    <span *ngIf="ApplicantState!=''">{{ApplicantState}}</span>
                                    <span *ngIf="Applicantpincode!=''">-{{Applicantpincode}}<br /></span>
                                </p>





                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <p class="font-18 text-dark mt-4 mb-4">Subject: Loan Disbursement letter for <span class="sec-head-black">“{{pLoanname}}”</span> Ref: Application No. <span class="sec-head-black">“{{VchapplicationID}}” </span> <span *ngIf="ApplicantMobileNo!=''">Mobile Number: <span class="sec-head-black">{{ApplicantMobileNo}}</span></span>
                                </p>


                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <p class="font-18 text-dark text-left">
                                    Dear Sir,
                                </p>
                            </div>
                            <div class="col-md-12">
                                <p class="font-18 text-dark mt-4 mb-4">
                                    As per the sanctioned loan amount of Rs. <span class="sec-head-black">{{Approvedloanamount | mycurrencypipe}}</span> for <span class="sec-head-black">“{{pLoanname}}”</span> on <span class="sec-head-black">{{ApprovedDate}}</span>,
                                    we are disbursing you a loan amount of Rs.<span class="sec-head-black">{{Disbursalamount | mycurrencypipe}}</span> through <span class="sec-head-black">{{Modeofpayment}}</span>. Please find the loan details which are
                                    mentioned below.



                                </p>

                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-8">
                                <table class="table mt-4">
                                    <tr>
                                        <td>Type of Facility</td>
                                        <td>{{Loantype}}</td>
                                    </tr>
                                    <tr>
                                        <td>Disbursal Amount</td>
                                        <td> {{Disbursalamount | mycurrencypipe}}</td>

                                    </tr>
                                    <tr>
                                        <td>Rate of Interest</td>
                                        <td>{{InterestRate}}% P.A</td>

                                    </tr>
                                    <tr>
                                        <td>Interest Type</td>
                                        <td>{{Interesttype}}</td>

                                    </tr>
                                    <tr>
                                        <td>Loan Tenure ({{Loanpayin}})</td>
                                        <td>{{Tenureofloan}}</td>

                                    </tr>
                                    <tr>
                                        <td>EMI Amount</td>
                                        <td>{{Installmentamount | mycurrencypipe}}</td>

                                    </tr>
                                    <tr>
                                        <td>Payment Mode</td>
                                        <td>{{Modeofpayment}}</td>

                                    </tr>







                                </table>

                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="temp-sign-box">
                                    <p class="font-18 text-dark mt-4 mb-4">
                                        Yours Sincerely
                                    </p>
                                    <hr>
                                    <p class="font-18 text-dark mt-4 mb-4">
                                        {{Applicantname}}
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="temp-sign-box">
                                    <p class="font-18 text-dark mt-4 mb-4 text-right">

                                        Authorized Signatory
                                    </p>
                                    <hr>
                                    <p class="font-18 text-dark mt-4 mb-4 text-right">
                                        Mrs Harita Rao
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </kendo-pdf-export>

            <div class="d-flex justify-content-end" *ngIf="Savebbutton">
                <a data-toggle="collapse" aria-expanded="true" class="btn btn-s-icon px-3 mt-4 border-0" (click)="save()"><img src="assets/images/icon-check-white.svg" width="20px" height="20px" class="mr-3">Save </a>
            </div>

        </div>
    </div>

</div>